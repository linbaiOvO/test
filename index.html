<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—ç™½çš„æ—¥è®°æœ¬ - ç™»å½•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap');
        body { font-family: 'Noto Serif SC', serif; }
        .bg-pattern { background-image: radial-gradient(#fbcfe8 1px, transparent 1px); background-size: 20px 20px; background-color: #fdf2f8; }
        .animate-float { animation: float 6s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
    </style>
</head>
<body class="bg-pattern min-h-screen flex flex-col items-center justify-center p-6 text-center relative overflow-hidden">

    <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-purple-200/30 rounded-full blur-3xl animate-float"></div>
    <div class="absolute bottom-1/4 right-1/4 w-80 h-80 bg-pink-200/30 rounded-full blur-3xl animate-float" style="animation-delay: -2s;"></div>

    <main class="relative z-10 bg-white/60 backdrop-blur-sm p-12 rounded-[3rem] shadow-xl border border-white/50 max-w-md w-full">
        <div class="text-6xl mb-6">ğŸ”’</div>
        <h1 class="text-4xl font-bold text-slate-800 mb-2">æ—ç™½çš„æ—¥è®°æœ¬</h1>
        <p class="text-slate-400 text-sm mb-10">ç§å¯†ç©ºé—´ï¼Œé—²äººå…è¿›</p>

        <!-- ç™»å½•çŠ¶æ€æ˜¾ç¤º -->
        <div id="loadingState" class="hidden text-pink-500 font-bold mb-4 animate-pulse">æ­£åœ¨éªŒè¯èº«ä»½å–µ...</div>

        <!-- ç™»å½•æŒ‰é’® -->
        <button id="showLoginBtn" class="group relative inline-flex items-center justify-center px-8 py-4 font-bold text-white transition-all duration-200 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full hover:shadow-lg active:scale-95 w-full">
            <span class="relative flex items-center gap-2">
                <i data-lucide="key" class="w-5 h-5"></i> è§£é”æ—¥è®°
            </span>
        </button>
    </main>

    <!-- ğŸ” ç™»å½•å¼¹çª— (Modal) -->
    <div id="loginModal" class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white w-full max-w-sm rounded-3xl shadow-2xl p-8 relative animate-scale-up">
            <button id="closeModal" class="absolute top-4 right-4 text-slate-400 hover:text-slate-600"><i data-lucide="x" class="w-6 h-6"></i></button>
            
            <h2 class="text-xl font-bold text-slate-700 mb-6 text-center">èº«ä»½éªŒè¯</h2>
            
            <div class="space-y-4">
                <div>
                    <input type="email" id="email" placeholder="è´¦å· (Email)" class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-pink-300 transition-all">
                </div>
                <div>
                    <input type="password" id="password" placeholder="å¯†ç " class="w-full p-3 rounded-xl bg-slate-50 border border-slate-200 focus:outline-none focus:ring-2 focus:ring-pink-300 transition-all">
                </div>
                <button id="loginBtn" class="w-full py-3 bg-pink-500 hover:bg-pink-600 text-white rounded-xl font-bold shadow-md transition-all active:scale-95">
                    ç™»å½•
                </button>
            </div>
            <p id="errorMsg" class="text-red-500 text-xs text-center mt-4 hidden"></p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDdqCijPyu6KDVAQMIrNUV2qAPTkk0Ree0",
            authDomain: "linbai-blog.firebaseapp.com",
            projectId: "linbai-blog",
            storageBucket: "linbai-blog.firebasestorage.app",
            messagingSenderId: "69762708684",
            appId: "1:69762708684:web:fb906d0cff4074730abe69",
            measurementId: "G-6S4NBJPSMJ"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        lucide.createIcons();
        const modal = document.getElementById('loginModal');
        const showLoginBtn = document.getElementById('showLoginBtn');
        const loginBtn = document.getElementById('loginBtn');
        const emailInput = document.getElementById('email');
        const passInput = document.getElementById('password');
        const errorMsg = document.getElementById('errorMsg');
        const loadingState = document.getElementById('loadingState');

        // å¦‚æœå·²ç»ç™»å½•ï¼Œç›´æ¥è¿›æ—¥è®°
        onAuthStateChanged(auth, (user) => {
            if (user) {
                loadingState.innerText = "æ¬¢è¿å›æ¥ï¼Œæ¬§å°¼é…±ï¼æ­£åœ¨è·³è½¬...";
                loadingState.classList.remove('hidden');
                showLoginBtn.classList.add('hidden');
                setTimeout(() => window.location.href = 'diary.html', 1000);
            }
        });

        // æ‰“å¼€å¼¹çª—
        showLoginBtn.onclick = () => {
            modal.classList.remove('hidden');
            emailInput.focus();
        };
        document.getElementById('closeModal').onclick = () => modal.classList.add('hidden');

        // ç™»å½•é€»è¾‘
        loginBtn.onclick = async () => {
            const email = emailInput.value;
            const pass = passInput.value;
            
            if(!email || !pass) return;

            loginBtn.disabled = true;
            loginBtn.innerText = "éªŒè¯ä¸­...";
            errorMsg.classList.add('hidden');

            try {
                await signInWithEmailAndPassword(auth, email, pass);
                // æˆåŠŸåï¼ŒonAuthStateChanged ä¼šè‡ªåŠ¨å¤„ç†è·³è½¬
            } catch (error) {
                console.error(error);
                errorMsg.innerText = "è´¦å·æˆ–å¯†ç ä¸å¯¹å“¦ï¼Œä¸è®¸å·çœ‹ï¼ğŸ˜¤";
                errorMsg.classList.remove('hidden');
                loginBtn.disabled = false;
                loginBtn.innerText = "ç™»å½•";
            }
        };
    </script>
    <style> .animate-scale-up { animation: scaleUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); } @keyframes scaleUp { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } } </style>
</body>
</html>
